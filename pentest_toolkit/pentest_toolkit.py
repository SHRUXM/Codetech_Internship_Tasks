import port_scanner
import brute_forcer


def main():
    while True:
        print("\nPenetration Testing Toolkit")
        print("1. Port Scanner")
        print("2. SSH Brute-Forcer")  # You can expand this for other services
        print("3. Exit")

        choice = input("Enter your choice: ")

        if choice == '1':
            target_ip = input("Enter target IP address: ")
            ports_input = input("Enter port(s) to scan (e.g., 22,23,80-85): ")
            ports_to_scan = []
            port_ranges = ports_input.split(',')
            for port_range in port_ranges:
                if '-' in port_range:
                    start, end = map(int, port_range.split('-'))
                    ports_to_scan.extend(range(start, end + 1))
                else:
                    ports_to_scan.append(int(port_range))
            port_scanner.scan_target(target_ip, ports_to_scan)

        elif choice == '2':
            target_ip = input("Enter target IP address: ")
            username_list_path = input("Enter path to username list file: ")
            password_list_path = input("Enter path to password list file: ")
            brute_forcer.brute_force_ssh(target_ip, username_list_path, password_list_path)

        elif choice == '3':
            print("Exiting...")
            break

        else:
            print("Invalid choice. Please try again.")

if __name__ == "__main__":
    main()